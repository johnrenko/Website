---
import BaseLayout from "../layouts/BaseLayout.astro";
import HeroHeader from "../components/HeroHeader.astro";
import ExperimentsGrid from "../components/ExperimentsGrid.astro";
import { getCollection } from 'astro:content';
import CVSummary from "../components/CVSummary.astro";
import WorkCard from "../components/WorkCard.astro";
const works = await getCollection('work');
const sortedWorks = works
  .slice()
  .sort((a, b) => {
    const orderA = typeof a.data.order === 'number' ? a.data.order : Number.POSITIVE_INFINITY;
    const orderB = typeof b.data.order === 'number' ? b.data.order : Number.POSITIVE_INFINITY;
    if (orderA !== orderB) return orderA - orderB; // lower order first
    // Fallback: most recent date first (date is YYYY-MM)
    return (b.data.date || '').localeCompare(a.data.date || '');
  });
// Removed unused experiments collection fetch to avoid build error when empty
---
<BaseLayout title="John Dutamby ‚Äî Portfolio" >
  <HeroHeader name="JOHN DUTAMBY" />

  <section id="work" class="mb-32">
    <div class="text-center max-w-4xl mx-auto">
      <h2 class="font-display text-3xl mb-6">Projets phares</h2>
      <p class="text-zinc-600 mb-12 text-lg leading-relaxed">
        Une s√©lection de mes r√©alisations illustrant mes conceptions design √† travers divers secteurs.
      </p>
      <div class="work-grid">
        {sortedWorks.map((w) => (
          <WorkCard
            href={`/work/${w.id}`}
            company={w.data.title.split(' ‚Äî ')[0] ?? ''}
            role={w.data.role}
            title={w.data.summary}
            cover={w.data.cover}
            coverAlt={w.data.title}
          />
        ))}
      </div>
    </div>
  </section>

  <!-- Animated Separator -->
  <div class="section-separator mb-32">
    <div class="separator-line"></div>
    <div class="separator-dot"></div>
    <div class="separator-line"></div>
  </div>

  <section id="experiments" class="mb-32">
    <div class="text-center max-w-4xl mx-auto">
      <h2 class="font-display text-3xl mb-6">Explorations cr√©atives</h2>
      <p class="text-zinc-600 mb-12 text-lg leading-relaxed">
        Une collection d‚Äôexp√©rimentations, de photos, de maquettes, de prototypes, de genAI...
      </p>
      <ExperimentsGrid />
    </div>
  </section>

  <!-- Animated Separator -->
  <div class="section-separator mb-32">
    <div class="separator-line"></div>
    <div class="separator-dot"></div>
    <div class="separator-line"></div>
  </div>

  <section id="cv" class="mb-32">
    <div class="text-center max-w-4xl mx-auto">
      <h2 class="font-display text-3xl mb-6">Parcours professionnel</h2>
      <p class="text-zinc-600 mb-12 text-lg leading-relaxed">
        Form√© comme ing√©nieur, j‚Äôai fait mes armes en recherche utilisateur avant de ma√Ætriser l‚Äôensemble du processus design, de la d√©couverte au delivery. En plus de 15 ans d‚Äôexp√©rience, j‚Äôai travaill√© √† l‚Äôinternational et alli√© design, d√©veloppement et strat√©gie produit dans des domaines vari√©s : logiciels de comptabilit√©, retail, e-commerce, sant√©... Mon obsession : rendre la complexit√© intuitive.
      </p>
      <CVSummary />
    </div>
  </section>

  <!-- Animated Separator -->
  <div class="section-separator mb-32">
    <div class="separator-line"></div>
    <div class="separator-dot"></div>
    <div class="separator-line"></div>
  </div>

  <section id="contact" class="mb-32">
    <div class="text-center max-w-2xl mx-auto">
      <h2 class="font-display text-3xl mb-6">Rentrons en contact !</h2>
      <p class="text-zinc-600 mb-8 text-lg leading-relaxed">
        Je suis toujours ouvert √† de nouvelles collaborations, missions freelance ou opportunit√©s full-time, ainsi qu‚Äô√† toute discussion autour du design, du produit et de l‚Äôinnovation.
      </p>
      
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-6 mb-8">
        <button type="button" class="contact-card group" data-copy-email>
          <div class="contact-icon">
            <span class="contact-icon-default">‚úâ</span>
            <span class="contact-icon-hover">üìã</span>
          </div>
          <div class="contact-content">
            <h3 class="contact-title">Email</h3>
            <p class="contact-subtitle">Cliquez pour copier mon email</p>
          </div>
        </button>
        
        <a href="https://www.linkedin.com/in/johndutamby/" class="contact-card group" rel="noopener" target="_blank">
          <div class="contact-icon">üíº</div>
          <div class="contact-content">
            <h3 class="contact-title">LinkedIn</h3>
            <p class="contact-subtitle">Ajoutez moi √† votre r√©seau</p>
          </div>
        </a>
      </div>
      
      <div class="flex justify-center">
        <span class="inline-flex items-center gap-2 rounded-full border border-green-200 bg-green-50 px-2.5 py-1 text-xs font-medium text-green-700">
          <span class="h-2 w-2 rounded-full bg-green-500"></span>
          Disponible
        </span>
      </div>
    </div>
  </section>

  <!-- Copy to clipboard notification -->
  <div id="copy-notification" class="copy-notification hidden">
    <div class="copy-notification-content">
      <span class="copy-notification-icon">‚úì</span>
      <span class="copy-notification-text">Email copi√©</span>
    </div>
  </div>

  <script>
    // Copy email to clipboard functionality
    (function() {
      const emailButton = document.querySelector('[data-copy-email]');
      const notification = document.getElementById('copy-notification');
      const email = 'john.dutamby@gmail.com';
      
      if (!emailButton || !notification) return;
      
      async function copyEmailToClipboard() {
        try {
          await navigator.clipboard.writeText(email);
          
          // Show notification
          notification.classList.remove('hidden');
          
          // Hide notification after 3 seconds
          setTimeout(() => {
            notification.classList.add('hidden');
          }, 3000);
          
        } catch (err) {
          console.error('Failed to copy email:', err);
          // Fallback: show alert
          alert(`Email: ${email}`);
        }
      }
      
      emailButton.addEventListener('click', copyEmailToClipboard);
    })();
  </script>
</BaseLayout>


